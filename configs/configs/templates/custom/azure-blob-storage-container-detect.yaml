id: azure-blob-storage-container-detect

info:
  name: Azure Blob Storage Container - Detect
  author: MethodSecurity
  severity: info
  description: Azure Blob Storage Container was detected.
  reference: https://learn.microsoft.com/en-us/azure/storage/blobs/
  tags: exposure,bucket,azure

variables:
  ContainerPath: '{{replace_regex(BaseURL, "^(https?://[^/]+/[^/]+).*", "${1}")}}'

requests:
  - method: GET
    path:
      - "{{ContainerPath}}?restype=container&comp=metadata"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 403

      - type: dsl
        dsl:
          - 'contains(to_lower(server), "microsoft-httpapi/2.0")'
          - 'contains(to_lower(header), "x-ms-request-id")'
        condition: and

    extractors:        
      - type: dsl
        name: container_url
        dsl:
          - to_lower(ContainerPath)

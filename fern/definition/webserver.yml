imports:
  common: ./common.yml
# Enums
types:
  ModuleName:
    enum:
      - BUFFER_OVERFLOW_CONTENT_HEADER
      - CRLF_INJECTION
      - PATH_TRAVERSAL
      - RCE_MOD_FILE
      - REVERSE_PROXY_MISCONFIGURATION
      - X_POWERED_BY_HEADER_GRAB
  ProbeType:
    enum:
      - ENUMERATE
      - VALIDATE
  ServerType:
    enum:
      - APACHE
      - NGINX
# Config Struct
  WebServerTypeConfig:
    properties:
      targets: list<string>
      modules: list<ModuleName>
      server: ServerType
      probe: ProbeType
      timeout: integer
      successfulOnly: boolean
# Request/Response Structs
  ResponseUnion: 
    union:
      GeneralResponse: GeneralResponseInfo
      VersionEnumerateResponse: VersionEnumerateResponseInfo
  VersionEnumerateResponseInfo:
    properties:
      statusCode: integer
      header: optional<string>
      versionType: optional<string>
      versionNumber: optional<string>
      error: optional<string>
  GeneralResponseInfo:
    properties:
      statusCode: integer
      body: optional<string>
      headers: optional<map<string,string>>
      error: optional<string>
  GeneralRequestInfo:
    properties:
      method: common.HttpMethod
      url: string
      headers: optional<map<string,string>>
# Attempt Structs
  PathInfo:
    properties:
      path: string
      request: GeneralRequestInfo
      response: optional<GeneralResponseInfo>
      finding: optional<boolean>
  MultiplePathsAttemptInfo:
    properties:
      paths: optional<list<PathInfo>>
  VersionEnumerateAttemptInfo:
    properties:
      request: GeneralRequestInfo
      response: optional<VersionEnumerateResponseInfo>
  GeneralAttemptInfo:
    properties:
      request: GeneralRequestInfo
      response: optional<GeneralResponseInfo>
# WebServer Report Struct
  AttemptInfoUnion: 
    union:
      MultiplePathsAttempt: MultiplePathsAttemptInfo
      GeneralAttempt: GeneralAttemptInfo
      VersionAttempt: VersionEnumerateAttemptInfo
  Attempt:
    properties:
      name: ModuleName
      timestamp: datetime
      AttemptInfo: optional<AttemptInfoUnion>
      finding : boolean
  WebServer:
    properties:
      target: string
      attempts: list<Attempt>
  WebServerReport:
    properties:
      server: ServerType
      probe: ProbeType
      webServers: optional<list<WebServer>>
      errors: optional<list<string>>